import{a as d,ag as m,b as p,r as g,j as s,s as a,c as r}from"./index-D8RFWrIc.js";const x=()=>{console.log("Callback component mounted");const o=d();return m(),p(),g.useEffect(()=>{const c=async()=>{var i;try{const{data:{session:e},error:n}=await a.auth.getSession();if(n){console.error("Session error:",n),r.error("Authentication failed"),o("/login");return}if(!(e!=null&&e.user)){r.error("Authentication failed",{description:"Please try logging in again"}),o("/login");return}const{data:f,error:t}=await a.from("profiles").select("*").eq("id",e.user.id).single();if(t&&t.code!=="PGRST116"){console.error("Profile fetch error:",t),r.error("Failed to fetch profile"),o("/login");return}if(!f){const{error:l}=await a.from("profiles").insert([{id:e.user.id,name:e.user.user_metadata.name||((i=e.user.email)==null?void 0:i.split("@")[0])||"User",email:e.user.email,join_date:new Date().toISOString(),timezone:"UTC"}]);l?(console.error("Profile creation error:",l),r.error("Profile setup failed",{description:"Please try updating your profile later"})):r.success("Profile created successfully")}r.success("Authentication successful"),o("/")}catch(e){console.error("Error in callback:",e),r.error("Authentication error"),o("/login")}},u=setTimeout(()=>{c()},1e3);return()=>clearTimeout(u)},[o]),s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"}),s.jsx("p",{className:"text-lg",children:"Verifying your account..."}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Please wait while we complete the process."})]})})};export{x as default};
//# sourceMappingURL=Callback-B23NFS3-.js.map
